<div class="dashboard-container">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <div class="welcome-card">
      <h1 class="welcome-title">Welcome, {{ user.firstName }} {{ user.lastName }}!</h1>
      <div class="points-display">
        <span class="points-label">Your Current Points:</span>
        <span class="points-value">{{ totalPoints }}</span>
      </div>
    </div>
  </div>

  <!-- Upcoming Matches Section -->
  <div class="matches-section">
    <h2 class="section-title">Upcoming Matches</h2>

    @if (upcomingMatches.length > 0) {
    <div class="table-container">
      <table class="matches-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Team A</th>
            <th>Team B</th>
            <th>Start Time</th>
            <th>Your Pick</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          @for (match of upcomingMatches; track match.id; let i = $index) {
          <tr class="match-row">
            <td>{{ i + 1 }}</td>
            <td>{{ match.teamA }}</td>
            <td>{{ match.teamB }}</td>
            <td>{{ match.startDateTime | date:'short' }}</td>
            <td>
              @if (match.userPick) {
              <span class="pick-badge pick-{{ match.userPick.toLowerCase() }}">
                {{ getTeamName(match, match.userPick) }}
              </span>
              } @else {
              <span class="no-pick">No Pick</span>
              }
            </td>
            <td class="actions-cell">
              @if (!isMatchStarted(match)) {
              <div class="pick-buttons">
                <button class="pick-btn team-a-btn" [disabled]="match.userPick === 'A'"
                  (click)="selectTeam(match, 'A')">
                  Pick Team A
                </button>
                <button class="pick-btn team-b-btn" [disabled]="match.userPick === 'B'"
                  (click)="selectTeam(match, 'B')">
                  Pick Team B
                </button>
              </div>
              } @else {
              <span class="match-locked">
                Locked ({{ getTeamName(match, match.userPick) }})
              </span>
              }
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    } @else {
    <div class="no-matches">
      <p>No upcoming matches found.</p>
    </div>
    }
  </div>

  <!-- Match History Section -->
  <div class="history-section">
    <h2 class="section-title">Your Match History</h2>

    @if (userHistory.length > 0) {
    <div class="table-container">
      <table class="matches-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Team A</th>
            <th>Team B</th>
            <th>Start Time</th>
            <th>Your Pick</th>
            <th>Winner</th>
            <th>Points</th>
            <th>Result</th>
          </tr>
        </thead>
        <tbody>
          @for (match of userHistory; track match.id; let i = $index) {
          <tr class="match-row">
            <td>{{ i + 1 }}</td>
            <td>{{ match.teamA }}</td>
            <td>{{ match.teamB }}</td>
            <td>{{ match.startDateTime | date:'short' }}</td>
            <td>
              @if (match.userPick) {
              <span class="pick-badge pick-{{ match.userPick.toLowerCase() }}">
                {{ getTeamName(match, match.userPick) }}
              </span>
              } @else {
              <span class="no-pick">No Pick</span>
              }
            </td>
            <td>
              @if (match.winner) {
              <span class="winner-badge">{{ getWinnerName(match) }}</span>
              } @else {
              <span class="tbd">TBD</span>
              }
            </td>
            <td>
              @if (match.pointsEarned) {
              <span class="points-earned">{{ match.pointsEarned }}</span>
              } @else {
              <span class="no-points">-</span>
              }
            </td>
            <td>
              @if (match.userPick === match.winner) {
              <span class="result-correct">✓ Correct</span>
              } @else {
              <span class="result-wrong">✗ Wrong</span>
              }
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    } @else {
    <div class="no-history">
      <p>No match history found. Start making picks to see your results!</p>
    </div>
    }
  </div>
</div>